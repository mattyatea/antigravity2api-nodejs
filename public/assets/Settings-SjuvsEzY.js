import{d as N,a as P,v as f,x as $,b as x,e as t,h as k,z as y,t as l,f as a,q as n,_ as d,w as g,E as b,G as w,l as S,H as E,I as U,C as F,p as _}from"./index-CDUZ-j6a.js";import{u as R,a as p}from"./useSettings-Dz22ztbU.js";const A={class:"w-full"},B={class:"grid grid-cols-1 gap-6 mb-6 items-stretch md:grid-cols-2 lg:grid-cols-3"},D={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:bg-black dark:border-gray-800"},z={class:"mb-4 text-sm font-bold text-black dark:text-white flex items-center gap-2 uppercase tracking-wider"},O={class:"mb-4 grid grid-cols-2 gap-4"},Y={class:"flex flex-col gap-1"},L={class:"flex flex-col gap-1"},G={class:"mb-4 grid grid-cols-2 gap-4"},J={class:"flex flex-col gap-1"},K={class:"flex flex-col gap-1"},X={class:"mb-4 flex flex-col gap-2"},H={class:"flex items-center justify-between gap-3 rounded border border-gray-200 p-2 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-900"},Q={class:"relative inline-block h-5 w-9 shrink-0 cursor-pointer"},W={class:"flex items-center justify-between gap-3 rounded border border-gray-200 p-2 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-900"},Z={class:"relative inline-block h-5 w-9 shrink-0 cursor-pointer"},ee={class:"mb-4 flex flex-col gap-1"},te={class:"flex flex-col gap-1"},oe={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:bg-black dark:border-gray-800"},se={class:"mb-4 text-sm font-bold text-black dark:text-white flex items-center gap-2 uppercase tracking-wider"},re={class:"mb-4 grid grid-cols-2 gap-4"},ae={class:"flex flex-col gap-1"},le={class:"flex flex-col gap-1"},ne={class:"mb-4 mt-2 flex flex-col gap-1"},de={class:"mb-4 flex flex-col gap-2"},ie={class:"flex items-center justify-between gap-3 rounded border border-gray-200 p-2 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-900"},ue={class:"relative inline-block h-5 w-9 shrink-0 cursor-pointer"},ge={class:"flex flex-col gap-2"},ce={class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},be={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:bg-black dark:border-gray-800"},pe={class:"mb-4 text-sm font-bold text-black dark:text-white flex items-center gap-2 uppercase tracking-wider"},me={class:"mb-4 flex flex-col gap-2"},ve={class:"flex items-center justify-between gap-3 rounded border border-gray-200 p-2 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-900"},he={class:"relative inline-block h-5 w-9 shrink-0 cursor-pointer"},fe={class:"mb-4 grid grid-cols-2 gap-4"},xe={class:"flex flex-col gap-1"},ke={class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},ye={class:"relative"},we={value:"round_robin"},_e={value:"quota_exhausted"},je={value:"request_count"},Ve={key:0,class:"flex flex-col gap-1"},Ce={key:0,class:"mt-2 flex items-center gap-2 rounded bg-gray-50 px-3 py-2 text-xs font-mono text-gray-600 border border-gray-100 dark:bg-gray-900 dark:border-gray-800 dark:text-gray-400"},Se={class:"mt-6 flex flex-col gap-2 border-t border-gray-100 pt-4 dark:border-gray-800"},Ue={class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},Me={class:"flex items-center gap-3"},qe={class:"flex justify-start gap-4 mt-8"},$e=N({__name:"Settings",setup(Te){const{showToast:c}=F(),{fontSize:u,setFontSize:j}=R(),{t:r}=P(),o=f({env:{},json:{server:{},defaults:{},other:{},rotation:{}}}),m=f(""),V=f(!1);async function v(){try{const e=await(await p("/admin/config")).json();e.success&&(o.value=e.data,o.value.json.server||(o.value.json.server={}),o.value.json.defaults||(o.value.json.defaults={}),o.value.json.other||(o.value.json.other={}),o.value.json.rotation||(o.value.json.rotation={}),C(),M())}catch(i){c(`${r("common.error")}: ${i.message}`,"error")}}async function M(){try{const e=await(await p("/admin/rotation")).json();if(e.success){const{strategy:s,requestCount:T,currentIndex:I}=e.data;let h={round_robin:r("settings.strategy_round_robin"),quota_exhausted:r("settings.strategy_quota"),request_count:r("settings.strategy_count")}[s]||s;s==="request_count"&&(h+=` (${r("settings.request_count")}: ${T})`),h+=` | Index: ${I}`,m.value=h}}catch{}}function C(){V.value=o.value.json.rotation.strategy==="request_count"}async function q(){c(r("common.loading"),"info");try{const i={env:o.value.env,json:o.value.json},s=await(await p("/admin/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();o.value.json.rotation&&Object.keys(o.value.json.rotation).length>0&&await p("/admin/rotation",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.value.json.rotation)}),s.success?(c(r("common.saved"),"success"),v()):c(`${r("common.error")}: ${s.message}`,"error")}catch(i){c(`${r("common.error")}: ${i.message}`,"error")}}return $(()=>{v()}),(i,e)=>(_(),x("div",A,[t("div",B,[t("div",D,[t("h4",z,[e[24]||(e[24]=k('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="8" x="2" y="2" rx="2" ry="2"></rect><rect width="20" height="8" x="2" y="14" rx="2" ry="2"></rect><line x1="6" x2="6.01" y1="6" y2="6"></line><line x1="6" x2="6.01" y1="18" y2="18"></line></svg>',1)),y(" "+l(a(r)("settings.server")),1)]),t("div",O,[t("div",Y,[n(d,{modelValue:o.value.json.server.port,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.json.server.port=s),modelModifiers:{number:!0},label:a(r)("settings.server_port"),type:"number",placeholder:"8045"},null,8,["modelValue","label"])]),t("div",L,[n(d,{modelValue:o.value.json.server.host,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.json.server.host=s),label:a(r)("settings.server_host"),placeholder:"0.0.0.0"},null,8,["modelValue","label"])])]),t("div",G,[t("div",J,[n(d,{modelValue:o.value.json.server.maxRequestSize,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.json.server.maxRequestSize=s),label:a(r)("settings.max_request_size"),placeholder:"500mb"},null,8,["modelValue","label"])]),t("div",K,[n(d,{modelValue:o.value.env.API_KEY,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.env.API_KEY=s),label:a(r)("settings.api_key"),type:"password",placeholder:"***"},null,8,["modelValue","label"])])]),t("div",X,[t("div",H,[t("label",{class:"flex-1 text-xs font-medium text-gray-700 cursor-pointer dark:text-gray-300",onClick:e[4]||(e[4]=s=>o.value.json.other.skipProjectIdFetch=!o.value.json.other.skipProjectIdFetch)},l(a(r)("settings.skip_verify")),1),t("label",Q,[g(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>o.value.json.other.skipProjectIdFetch=s),class:"peer sr-only"},null,512),[[b,o.value.json.other.skipProjectIdFetch]]),e[25]||(e[25]=t("span",{class:"absolute inset-0 rounded-full bg-gray-200 transition-all peer-checked:bg-black dark:bg-gray-700 dark:peer-checked:bg-white"},null,-1)),e[26]||(e[26]=t("span",{class:"absolute bottom-0.5 left-0.5 h-4 w-4 rounded-full bg-white transition-all peer-checked:translate-x-4 shadow border border-gray-100 dark:border-gray-800 dark:bg-black"},null,-1))])]),t("div",W,[t("label",{class:"flex-1 text-xs font-medium text-gray-700 cursor-pointer dark:text-gray-300",onClick:e[6]||(e[6]=s=>o.value.json.other.useNativeAxios=!o.value.json.other.useNativeAxios)},l(a(r)("settings.native_axios")),1),t("label",Z,[g(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=s=>o.value.json.other.useNativeAxios=s),class:"peer sr-only"},null,512),[[b,o.value.json.other.useNativeAxios]]),e[27]||(e[27]=t("span",{class:"absolute inset-0 rounded-full bg-gray-200 transition-all peer-checked:bg-black dark:bg-gray-700 dark:peer-checked:bg-white"},null,-1)),e[28]||(e[28]=t("span",{class:"absolute bottom-0.5 left-0.5 h-4 w-4 rounded-full bg-white transition-all peer-checked:translate-x-4 shadow border border-gray-100 dark:border-gray-800 dark:bg-black"},null,-1))])])]),t("div",ee,[n(d,{modelValue:o.value.env.IMAGE_BASE_URL,"onUpdate:modelValue":e[8]||(e[8]=s=>o.value.env.IMAGE_BASE_URL=s),label:a(r)("settings.image_url"),placeholder:"https://your-domain"},null,8,["modelValue","label"])]),t("div",te,[n(d,{modelValue:o.value.env.PROXY,"onUpdate:modelValue":e[9]||(e[9]=s=>o.value.env.PROXY=s),label:a(r)("settings.proxy"),placeholder:"http://127.0.0.1:7890"},null,8,["modelValue","label"])])]),t("div",oe,[t("h4",se,[e[29]||(e[29]=k('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5"></path><path d="M8.5 8.5v.01"></path><path d="M16 15.5v.01"></path><path d="M12 12v.01"></path><path d="M8.5 4.5v.01"></path><path d="M15.5 8.5v.01"></path></svg>',1)),y(" "+l(a(r)("settings.models")),1)]),t("div",re,[t("div",ae,[n(d,{modelValue:o.value.json.defaults.temperature,"onUpdate:modelValue":e[10]||(e[10]=s=>o.value.json.defaults.temperature=s),modelModifiers:{number:!0},label:a(r)("settings.temperature"),type:"number",placeholder:"1",step:"0.1"},null,8,["modelValue","label"])]),t("div",le,[n(d,{modelValue:o.value.json.defaults.topP,"onUpdate:modelValue":e[11]||(e[11]=s=>o.value.json.defaults.topP=s),modelModifiers:{number:!0},label:a(r)("settings.top_p"),type:"number",placeholder:"1",step:"0.01"},null,8,["modelValue","label"])])]),t("div",ne,[n(d,{modelValue:o.value.json.defaults.thinkingBudget,"onUpdate:modelValue":e[12]||(e[12]=s=>o.value.json.defaults.thinkingBudget=s),modelModifiers:{number:!0},label:a(r)("settings.thinking_budget"),type:"number",placeholder:"16000"},null,8,["modelValue","label"])]),t("div",de,[t("div",ie,[t("label",{class:"flex-1 text-xs font-medium text-gray-700 cursor-pointer dark:text-gray-300",onClick:e[13]||(e[13]=s=>o.value.json.other.useContextSystemPrompt=!o.value.json.other.useContextSystemPrompt)},l(a(r)("settings.context_system")),1),t("label",ue,[g(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>o.value.json.other.useContextSystemPrompt=s),class:"peer sr-only"},null,512),[[b,o.value.json.other.useContextSystemPrompt]]),e[30]||(e[30]=t("span",{class:"absolute inset-0 rounded-full bg-gray-200 transition-all peer-checked:bg-black dark:bg-gray-700 dark:peer-checked:bg-white"},null,-1)),e[31]||(e[31]=t("span",{class:"absolute bottom-0.5 left-0.5 h-4 w-4 rounded-full bg-white transition-all peer-checked:translate-x-4 shadow border border-gray-100 dark:border-gray-800 dark:bg-black"},null,-1))])])]),t("div",ge,[t("label",ce,l(a(r)("settings.system_instruction")),1),g(t("textarea",{class:"w-full min-h-[100px] resize-y rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-black placeholder:text-gray-400 focus:border-black focus:outline-none focus:ring-1 focus:ring-black dark:border-gray-700 dark:bg-black dark:text-white dark:focus:border-white dark:focus:ring-white","onUpdate:modelValue":e[15]||(e[15]=s=>o.value.env.SYSTEM_INSTRUCTION=s),rows:"4"},null,512),[[w,o.value.env.SYSTEM_INSTRUCTION]])])]),t("div",be,[t("h4",pe,[e[32]||(e[32]=k('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"></path><path d="M16 21h5v-5"></path></svg>',1)),y(" "+l(a(r)("settings.rotation")),1)]),t("div",me,[t("div",ve,[t("label",{class:"flex-1 text-xs font-medium text-gray-700 cursor-pointer dark:text-gray-300",onClick:e[16]||(e[16]=s=>o.value.json.other.passSignatureToClient=!o.value.json.other.passSignatureToClient)},l(a(r)("settings.pass_signature")),1),t("label",he,[g(t("input",{type:"checkbox","onUpdate:modelValue":e[17]||(e[17]=s=>o.value.json.other.passSignatureToClient=s),class:"peer sr-only"},null,512),[[b,o.value.json.other.passSignatureToClient]]),e[33]||(e[33]=t("span",{class:"absolute inset-0 rounded-full bg-gray-200 transition-all peer-checked:bg-black dark:bg-gray-700 dark:peer-checked:bg-white"},null,-1)),e[34]||(e[34]=t("span",{class:"absolute bottom-0.5 left-0.5 h-4 w-4 rounded-full bg-white transition-all peer-checked:translate-x-4 shadow border border-gray-100 dark:border-gray-800 dark:bg-black"},null,-1))])])]),t("div",fe,[t("div",xe,[t("label",ke,l(a(r)("settings.strategy")),1),t("div",ye,[g(t("select",{class:"w-full appearance-none rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-black focus:border-black focus:outline-none focus:ring-1 focus:ring-black dark:border-gray-700 dark:bg-black dark:text-white dark:focus:border-white dark:focus:ring-white cursor-pointer",style:{"background-image":"url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22m6%208%204%204%204-4%22%2F%3E%3C%2Fsvg%3E')","background-position":"right 0.75rem center","background-repeat":"no-repeat","background-size":"1.25em 1.25em"},"onUpdate:modelValue":e[18]||(e[18]=s=>o.value.json.rotation.strategy=s),onChange:C},[t("option",we,l(a(r)("settings.strategy_round_robin")),1),t("option",_e,l(a(r)("settings.strategy_quota")),1),t("option",je,l(a(r)("settings.strategy_count")),1)],544),[[E,o.value.json.rotation.strategy]])])]),V.value?(_(),x("div",Ve,[n(d,{modelValue:o.value.json.rotation.requestCount,"onUpdate:modelValue":e[19]||(e[19]=s=>o.value.json.rotation.requestCount=s),modelModifiers:{number:!0},label:a(r)("settings.request_count"),type:"number",min:"1",placeholder:"10"},null,8,["modelValue","label"])])):S("",!0)]),m.value?(_(),x("div",Ce,l(m.value),1)):S("",!0),t("div",Se,[t("label",Ue,l(a(r)("settings.font_size"))+" (px)",1),t("div",Me,[g(t("input",{class:"h-1.5 flex-1 cursor-pointer appearance-none rounded-full bg-gray-200 accent-black dark:bg-gray-800 dark:accent-white",type:"range",min:"10",max:"24","onUpdate:modelValue":e[20]||(e[20]=s=>U(u)?u.value=s:null),onInput:e[21]||(e[21]=s=>a(j)(a(u)))},null,544),[[w,a(u)]]),g(t("input",{class:"w-[60px] rounded-md border border-gray-300 bg-white px-2 py-1 text-center text-sm text-black focus:border-black focus:outline-none focus:ring-1 focus:ring-black dark:border-gray-700 dark:bg-black dark:text-white",type:"number",min:"10",max:"24","onUpdate:modelValue":e[22]||(e[22]=s=>U(u)?u.value=s:null),onChange:e[23]||(e[23]=s=>a(j)(a(u)))},null,544),[[w,a(u)]])])])])]),t("div",qe,[t("button",{onClick:q,class:"inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2 disabled:bg-opacity-50 disabled:cursor-not-allowed h-11 bg-black text-white hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200 min-w-[120px] justify-center"},l(a(r)("settings.save_config")),1),t("button",{onClick:v,class:"inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2 disabled:bg-opacity-50 disabled:cursor-not-allowed h-11 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-black dark:text-gray-300 dark:hover:bg-gray-900 min-w-[120px] justify-center"},l(a(r)("settings.reload_config")),1)])]))}});export{$e as default};
